generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  avatar    String?
  role      String   @default("user")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  linkedinAccounts LinkedInAccount[]
  prospects        Prospect[]
  automationRules  AutomationRule[]
  contentTopics    ContentTopic[]
}

model LinkedInAccount {
  id          String   @id @default(cuid())
  userId      String
  name        String
  cookie      String
  status      String   @default("active")
  riskLevel   Int      @default(0)
  dailyLimit  Int      @default(50)
  usedToday   Int      @default(0)
  lastSync    DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Prospect {
  id          String   @id @default(cuid())
  userId      String
  linkedinId  String
  name        String
  title       String?
  company     String?
  location    String?
  profileUrl  String?
  notes       String?
  tags        String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model AutomationRule {
  id          String   @id @default(cuid())
  userId      String
  name        String
  trigger     String
  conditions  String?
  actions     String
  enabled     Boolean  @default(true)
  schedule    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model ContentTopic {
  id            String    @id @default(cuid())
  userId        String
  keywords      String
  searchInterval Int     @default(60)
  lastCrawl     DateTime?
  status        String    @default("active")
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  user    User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  articles ContentArticle[]
}

model ContentArticle {
  id          String   @id @default(cuid())
  topicId     String
  title       String
  url         String
  author      String?
  engagement  Int      @default(0)
  summary     String?
  createdAt   DateTime @default(now())

  topic ContentTopic @relation(fields: [topicId], references: [id], onDelete: Cascade)
}
